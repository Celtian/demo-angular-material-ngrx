import{ca as f,da as d,ha as x,na as k,oa as K,pa as G,q as S,qa as a,r as w,ra as H,s as _,t as T,u as N,x as L}from"./chunk-QBUF5525.js";import{Ma as D,a as E,b as I,ga as v,ja as M,jc as q,ma as C,oa as u,pa as F,ta as b,ua as j}from"./chunk-K53XTB2W.js";var nt={APP:{POSTS:"app.posts",NOT_FOUND:"app.not-found"},POSTS:{DETAIL:"posts.detail",CREATE:"posts.create",EDIT:"posts.edit"}};var $="@ngrx/router-store/request",vt=f($,d()),A="@ngrx/router-store/navigation",Ct=f(A,d()),O="@ngrx/router-store/cancel",St=f(O,d()),y="@ngrx/router-store/error",Tt=f(y,d()),J="@ngrx/router-store/navigated",Nt=f(J,d());function At(t,e){let i=e;switch(i.type){case A:case y:case O:return{state:i.payload.routerState,navigationId:i.payload.event.id};default:return t}}var p=class{serialize(e){return{root:this.serializeRoute(e.root),url:e.url}}serializeRoute(e){let i=e.children.map(s=>this.serializeRoute(s));return{params:e.params,data:e.data,url:e.url,outlet:e.outlet,title:e.title,routeConfig:e.routeConfig?{path:e.routeConfig.path,pathMatch:e.routeConfig.pathMatch,redirectTo:e.routeConfig.redirectTo,outlet:e.routeConfig.outlet,title:typeof e.routeConfig.title=="string"?e.routeConfig.title:void 0}:null,queryParams:e.queryParams,fragment:e.fragment,firstChild:i[0],children:i}}},z=function(t){return t[t.PreActivation=1]="PreActivation",t[t.PostActivation=2]="PostActivation",t}(z||{}),W="router",V=new C("@ngrx/router-store Internal Configuration"),X=new C("@ngrx/router-store Configuration"),U=function(t){return t[t.Full=0]="Full",t[t.Minimal=1]="Minimal",t}(U||{});function it(t){return E({stateKey:W,serializer:p,navigationActionTiming:z.PreActivation},t)}var g=class{serialize(e){return{root:this.serializeRoute(e.root),url:e.url}}serializeRoute(e){let i=e.children.map(s=>this.serializeRoute(s));return{params:e.params,paramMap:e.paramMap,data:e.data,url:e.url,outlet:e.outlet,title:e.title,routeConfig:e.routeConfig?{component:e.routeConfig.component,path:e.routeConfig.path,pathMatch:e.routeConfig.pathMatch,redirectTo:e.routeConfig.redirectTo,outlet:e.routeConfig.outlet,title:e.routeConfig.title}:null,queryParams:e.queryParams,queryParamMap:e.queryParamMap,fragment:e.fragment,component:e.routeConfig?e.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:i[0],pathFromRoot:void 0,children:i}}},R=class{},c=function(t){return t[t.NONE=1]="NONE",t[t.ROUTER=2]="ROUTER",t[t.STORE=3]="STORE",t}(c||{}),Q=(()=>{class t{constructor(i,s,n,l,m,h){this.store=i,this.router=s,this.serializer=n,this.errorHandler=l,this.config=m,this.activeRuntimeChecks=h,this.lastEvent=null,this.routerState=null,this.trigger=c.NONE,this.stateKey=this.config.stateKey,!G()&&q()&&(h?.strictActionSerializability||h?.strictStateSerializability)&&this.serializer instanceof g&&console.warn("@ngrx/router-store: The serializability runtime checks cannot be enabled with the FullRouterStateSerializer. The FullRouterStateSerializer has an unserializable router state and actions that are not serializable. To use the serializability runtime checks either use the MinimalRouterStateSerializer or implement a custom router state serializer."),this.setUpStoreStateListener(),this.setUpRouterEventsListener()}setUpStoreStateListener(){this.store.pipe(K(this.stateKey),v(this.store)).subscribe(([i,s])=>{this.navigateIfNeeded(i,s)})}navigateIfNeeded(i,s){if(!i||!i.state||this.trigger===c.ROUTER||this.lastEvent instanceof S)return;let n=i.state.url;rt(this.router.url,n)||(this.storeState=s,this.trigger=c.STORE,this.router.navigateByUrl(n).catch(l=>{this.errorHandler.handleError(l)}))}setUpRouterEventsListener(){let i=this.config.navigationActionTiming===z.PostActivation,s;this.router.events.pipe(v(this.store)).subscribe(([n,l])=>{this.lastEvent=n,n instanceof S?(this.routerState=this.serializer.serialize(this.router.routerState.snapshot),this.trigger!==c.STORE&&(this.storeState=l,this.dispatchRouterRequest(n))):n instanceof N?(s=n,!i&&this.trigger!==c.STORE&&this.dispatchRouterNavigation(n)):n instanceof _?(this.dispatchRouterCancel(n),this.reset()):n instanceof T?(this.dispatchRouterError(n),this.reset()):n instanceof w&&(this.trigger!==c.STORE&&(i&&this.dispatchRouterNavigation(s),this.dispatchRouterNavigated(n)),this.reset())})}dispatchRouterRequest(i){this.dispatchRouterAction($,{event:i})}dispatchRouterNavigation(i){let s=this.serializer.serialize(i.state);this.dispatchRouterAction(A,{routerState:s,event:new N(i.id,i.url,i.urlAfterRedirects,s)})}dispatchRouterCancel(i){this.dispatchRouterAction(O,{storeState:this.storeState,event:i})}dispatchRouterError(i){this.dispatchRouterAction(y,{storeState:this.storeState,event:new T(i.id,i.url,`${i}`)})}dispatchRouterNavigated(i){let s=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction(J,{event:i,routerState:s})}dispatchRouterAction(i,s){this.trigger=c.ROUTER;try{this.store.dispatch({type:i,payload:I(E({routerState:this.routerState},s),{event:this.config.routerState===U.Full?s.event:{id:s.event.id,url:s.event.url,urlAfterRedirects:s.event.urlAfterRedirects}})})}finally{this.trigger=c.NONE}}reset(){this.trigger=c.NONE,this.storeState=null,this.routerState=null}static{this.\u0275fac=function(s){return new(s||t)(u(k),u(L),u(R),u(D),u(X),u(x))}}static{this.\u0275prov=M({token:t,factory:t.\u0275fac})}}return t})();function rt(t,e){return B(t)===B(e)}function B(t){return t?.length>0&&t[t.length-1]==="/"?t.substring(0,t.length-1):t}function Ot(t={}){return b([{provide:V,useValue:t},{provide:X,useFactory:it,deps:[V]},{provide:R,useClass:t.serializer?t.serializer:t.routerState===U.Full?g:p},j(()=>F(Q)),Q])}function st(){return H(W)}function yt(t=st()){let e=a(t,r=>r&&r.state),i=a(e,r=>r&&r.root),s=a(i,r=>{if(!r)return;let o=r;for(;o.firstChild;)o=o.firstChild;return o}),n=a(i,r=>r&&r.fragment),l=a(i,r=>r&&r.queryParams),m=r=>a(l,o=>o&&o[r]),h=a(s,r=>r&&r.params),Y=r=>a(h,o=>o&&o[r]),P=a(s,r=>r&&r.data),Z=r=>a(P,o=>o&&o[r]),tt=a(e,r=>r&&r.url),et=a(s,r=>{if(r?.routeConfig)return typeof r.routeConfig.title=="string"?r.routeConfig.title:r.title});return{selectCurrentRoute:s,selectFragment:n,selectQueryParams:l,selectQueryParam:m,selectRouteParams:h,selectRouteParam:Y,selectRouteData:P,selectRouteDataParam:Z,selectUrl:tt,selectTitle:et}}export{At as a,Ot as b,yt as c,nt as d};
