import{Aa as K,Ba as a,Ca as V,l as S,m as _,n as q,na as f,o as N,oa as d,p as T,s as w,sa as L,ya as x,za as k}from"./chunk-7OFNZTUW.js";import{Ba as F,Sa as j,a as m,b as U,ja as v,lc as D,ma as P,pa as C,ra as l,sa as M,wa as b}from"./chunk-53LLQH3N.js";var st={APP:{POSTS:"app.posts",NOT_FOUND:"app.not-found"},POSTS:{DETAIL:"posts.detail",CREATE:"posts.create",EDIT:"posts.edit"}};var B="@ngrx/router-store/request",mt=f(B,d()),A="@ngrx/router-store/navigation",vt=f(A,d()),O="@ngrx/router-store/cancel",Ct=f(O,d()),y="@ngrx/router-store/error",St=f(y,d()),Z="@ngrx/router-store/navigated",Nt=f(Z,d());function Tt(e,t){let r=t;switch(r.type){case A:case y:case O:return{state:r.payload.routerState,navigationId:r.payload.event.id};default:return e}}var p=class{serialize(t){return{root:this.serializeRoute(t.root),url:t.url}}serializeRoute(t){let r=t.children.map(s=>this.serializeRoute(s));return{params:t.params,data:t.data,url:t.url,outlet:t.outlet,title:t.title,routeConfig:t.routeConfig?{path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet,title:typeof t.routeConfig.title=="string"?t.routeConfig.title:void 0}:null,queryParams:t.queryParams,fragment:t.fragment,firstChild:r[0],children:r}}},I=function(e){return e[e.PreActivation=1]="PreActivation",e[e.PostActivation=2]="PostActivation",e}(I||{}),$="router",G=new C("@ngrx/router-store Internal Configuration"),J=new C("@ngrx/router-store Configuration");function et(e){return m({stateKey:$,serializer:p,navigationActionTiming:I.PreActivation},e)}var R=class{serialize(t){return{root:this.serializeRoute(t.root),url:t.url}}serializeRoute(t){let r=t.children.map(s=>this.serializeRoute(s));return{params:t.params,paramMap:t.paramMap,data:t.data,url:t.url,outlet:t.outlet,title:t.title,routeConfig:t.routeConfig?{component:t.routeConfig.component,path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet,title:t.routeConfig.title}:null,queryParams:t.queryParams,queryParamMap:t.queryParamMap,fragment:t.fragment,component:t.routeConfig?t.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:r[0],pathFromRoot:void 0,children:r}}},g=class{},c=function(e){return e[e.NONE=1]="NONE",e[e.ROUTER=2]="ROUTER",e[e.STORE=3]="STORE",e}(c||{}),H=(()=>{class e{constructor(r,s,o,u,E,h){this.store=r,this.router=s,this.serializer=o,this.errorHandler=u,this.config=E,this.activeRuntimeChecks=h,this.lastEvent=null,this.routerState=null,this.trigger=c.NONE,this.stateKey=this.config.stateKey,!K()&&D()&&(h?.strictActionSerializability||h?.strictStateSerializability)&&this.serializer instanceof R&&console.warn("@ngrx/router-store: The serializability runtime checks cannot be enabled with the FullRouterStateSerializer. The FullRouterStateSerializer has an unserializable router state and actions that are not serializable. To use the serializability runtime checks either use the MinimalRouterStateSerializer or implement a custom router state serializer."),this.setUpStoreStateListener(),this.setUpRouterEventsListener()}setUpStoreStateListener(){this.store.pipe(k(this.stateKey),v(this.store)).subscribe(([r,s])=>{this.navigateIfNeeded(r,s)})}navigateIfNeeded(r,s){if(!r||!r.state||this.trigger===c.ROUTER||this.lastEvent instanceof S)return;let o=r.state.url;rt(this.router.url,o)||(this.storeState=s,this.trigger=c.STORE,this.router.navigateByUrl(o).catch(u=>{this.errorHandler.handleError(u)}))}setUpRouterEventsListener(){let r=this.config.navigationActionTiming===I.PostActivation,s;this.router.events.pipe(v(this.store)).subscribe(([o,u])=>{this.lastEvent=o,o instanceof S?(this.routerState=this.serializer.serialize(this.router.routerState.snapshot),this.trigger!==c.STORE&&(this.storeState=u,this.dispatchRouterRequest(o))):o instanceof T?(s=o,!r&&this.trigger!==c.STORE&&this.dispatchRouterNavigation(o)):o instanceof q?(this.dispatchRouterCancel(o),this.reset()):o instanceof N?(this.dispatchRouterError(o),this.reset()):o instanceof _&&(this.trigger!==c.STORE&&(r&&this.dispatchRouterNavigation(s),this.dispatchRouterNavigated(o)),this.reset())})}dispatchRouterRequest(r){this.dispatchRouterAction(B,{event:r})}dispatchRouterNavigation(r){let s=this.serializer.serialize(r.state);this.dispatchRouterAction(A,{routerState:s,event:new T(r.id,r.url,r.urlAfterRedirects,s)})}dispatchRouterCancel(r){this.dispatchRouterAction(O,{storeState:this.storeState,event:r})}dispatchRouterError(r){this.dispatchRouterAction(y,{storeState:this.storeState,event:new N(r.id,r.url,`${r}`)})}dispatchRouterNavigated(r){let s=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction(Z,{event:r,routerState:s})}dispatchRouterAction(r,s){this.trigger=c.ROUTER;try{this.store.dispatch({type:r,payload:U(m({routerState:this.routerState},s),{event:this.config.routerState===0?s.event:{id:s.event.id,url:s.event.url,urlAfterRedirects:s.event.urlAfterRedirects}})})}finally{this.trigger=c.NONE}}reset(){this.trigger=c.NONE,this.storeState=null,this.routerState=null}static{this.\u0275fac=function(s){return new(s||e)(l(x),l(w),l(g),l(j),l(J),l(L))}}static{this.\u0275prov=P({token:e,factory:e.\u0275fac})}}return e})();function rt(e,t){return Q(e)===Q(t)}function Q(e){return e?.length>0&&e[e.length-1]==="/"?e.substring(0,e.length-1):e}function At(e={}){return F([{provide:G,useValue:e},{provide:J,useFactory:et,deps:[G]},{provide:g,useClass:e.serializer?e.serializer:e.routerState===0?R:p},{provide:b,multi:!0,useFactory(){return()=>M(H)}},H])}function it(){return V($)}function Ot(e=it()){let t=a(e,i=>i&&i.state),r=a(t,i=>i&&i.root),s=a(r,i=>{if(!i)return;let n=i;for(;n.firstChild;)n=n.firstChild;return n}),o=a(r,i=>i&&i.fragment),u=a(r,i=>i&&i.queryParams),E=i=>a(u,n=>n&&n[i]),h=a(s,i=>i&&i.params),W=i=>a(h,n=>n&&n[i]),z=a(s,i=>i&&i.data),X=i=>a(z,n=>n&&n[i]),Y=a(t,i=>i&&i.url),tt=a(s,i=>{if(i?.routeConfig)return typeof i.routeConfig.title=="string"?i.routeConfig.title:i.title});return{selectCurrentRoute:s,selectFragment:o,selectQueryParams:u,selectQueryParam:E,selectRouteParams:h,selectRouteParam:W,selectRouteData:z,selectRouteDataParam:X,selectUrl:Y,selectTitle:tt}}export{Tt as a,At as b,Ot as c,st as d};
