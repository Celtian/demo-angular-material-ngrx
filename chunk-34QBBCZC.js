import{ea as f,fa as d,ja as k,pa as K,q as N,qa as G,r as L,ra as H,s as x,sa as c,t as A,ta as V,u as S,x as _}from"./chunk-BAZYIJRF.js";import{Ca as q,a as v,b as M,ha as C,ka as F,na as T,oa as h,oc as w,pa as b,qa as j,ra as D}from"./chunk-HLPUULQB.js";var nt={APP:{POSTS:"app.posts",NOT_FOUND:"app.not-found"},POSTS:{DETAIL:"posts.detail",CREATE:"posts.create",EDIT:"posts.edit"}};var J="@ngrx/router-store/request",vt=f(J,d()),O="@ngrx/router-store/navigation",Ct=f(O,d()),y="@ngrx/router-store/cancel",Tt=f(y,d()),z="@ngrx/router-store/error",Nt=f(z,d()),W="@ngrx/router-store/navigated",At=f(W,d());function St(e,t){let o=t;switch(o.type){case O:case z:case y:return{state:o.payload.routerState,navigationId:o.payload.event.id};default:return e}}var R=class{serialize(t){return{root:this.serializeRoute(t.root),url:t.url}}serializeRoute(t){let o=t.children.map(i=>this.serializeRoute(i));return{params:t.params,data:t.data,url:t.url,outlet:t.outlet,title:t.title,routeConfig:t.routeConfig?{path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet,title:typeof t.routeConfig.title=="string"?t.routeConfig.title:void 0}:null,queryParams:t.queryParams,fragment:t.fragment,firstChild:o[0],children:o}}},U=function(e){return e[e.PreActivation=1]="PreActivation",e[e.PostActivation=2]="PostActivation",e}(U||{}),X="router",Q=new T("@ngrx/router-store Internal Configuration"),Y=new T("@ngrx/router-store Configuration"),P=function(e){return e[e.Full=0]="Full",e[e.Minimal=1]="Minimal",e}(P||{});function it(e){return v({stateKey:X,serializer:R,navigationActionTiming:U.PreActivation},e)}var m=class{serialize(t){return{root:this.serializeRoute(t.root),url:t.url}}serializeRoute(t){let o=t.children.map(i=>this.serializeRoute(i));return{params:t.params,paramMap:t.paramMap,data:t.data,url:t.url,outlet:t.outlet,title:t.title,routeConfig:t.routeConfig?{component:t.routeConfig.component,path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet,title:t.routeConfig.title}:null,queryParams:t.queryParams,queryParamMap:t.queryParamMap,fragment:t.fragment,component:t.routeConfig?t.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:o[0],pathFromRoot:void 0,children:o}}},E=class{},l=function(e){return e[e.NONE=1]="NONE",e[e.ROUTER=2]="ROUTER",e[e.STORE=3]="STORE",e}(l||{}),B=(()=>{let t=class t{constructor(i,s,n,u,g,p){this.store=i,this.router=s,this.serializer=n,this.errorHandler=u,this.config=g,this.activeRuntimeChecks=p,this.lastEvent=null,this.routerState=null,this.trigger=l.NONE,this.stateKey=this.config.stateKey,!H()&&w()&&(p?.strictActionSerializability||p?.strictStateSerializability)&&this.serializer instanceof m&&console.warn("@ngrx/router-store: The serializability runtime checks cannot be enabled with the FullRouterStateSerializer. The FullRouterStateSerializer has an unserializable router state and actions that are not serializable. To use the serializability runtime checks either use the MinimalRouterStateSerializer or implement a custom router state serializer."),this.setUpStoreStateListener(),this.setUpRouterEventsListener()}setUpStoreStateListener(){this.store.pipe(G(this.stateKey),C(this.store)).subscribe(([i,s])=>{this.navigateIfNeeded(i,s)})}navigateIfNeeded(i,s){if(!i||!i.state||this.trigger===l.ROUTER||this.lastEvent instanceof N)return;let n=i.state.url;rt(this.router.url,n)||(this.storeState=s,this.trigger=l.STORE,this.router.navigateByUrl(n).catch(u=>{this.errorHandler.handleError(u)}))}setUpRouterEventsListener(){let i=this.config.navigationActionTiming===U.PostActivation,s;this.router.events.pipe(C(this.store)).subscribe(([n,u])=>{this.lastEvent=n,n instanceof N?(this.routerState=this.serializer.serialize(this.router.routerState.snapshot),this.trigger!==l.STORE&&(this.storeState=u,this.dispatchRouterRequest(n))):n instanceof S?(s=n,!i&&this.trigger!==l.STORE&&this.dispatchRouterNavigation(n)):n instanceof x?(this.dispatchRouterCancel(n),this.reset()):n instanceof A?(this.dispatchRouterError(n),this.reset()):n instanceof L&&(this.trigger!==l.STORE&&(i&&this.dispatchRouterNavigation(s),this.dispatchRouterNavigated(n)),this.reset())})}dispatchRouterRequest(i){this.dispatchRouterAction(J,{event:i})}dispatchRouterNavigation(i){let s=this.serializer.serialize(i.state);this.dispatchRouterAction(O,{routerState:s,event:new S(i.id,i.url,i.urlAfterRedirects,s)})}dispatchRouterCancel(i){this.dispatchRouterAction(y,{storeState:this.storeState,event:i})}dispatchRouterError(i){this.dispatchRouterAction(z,{storeState:this.storeState,event:new A(i.id,i.url,`${i}`)})}dispatchRouterNavigated(i){let s=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction(W,{event:i,routerState:s})}dispatchRouterAction(i,s){this.trigger=l.ROUTER;try{this.store.dispatch({type:i,payload:M(v({routerState:this.routerState},s),{event:this.config.routerState===P.Full?s.event:{id:s.event.id,url:s.event.url,urlAfterRedirects:s.event.urlAfterRedirects}})})}finally{this.trigger=l.NONE}}reset(){this.trigger=l.NONE,this.storeState=null,this.routerState=null}};t.\u0275fac=function(s){return new(s||t)(h(K),h(_),h(E),h(q),h(Y),h(k))},t.\u0275prov=F({token:t,factory:t.\u0275fac});let e=t;return e})();function rt(e,t){return $(e)===$(t)}function $(e){return e?.length>0&&e[e.length-1]==="/"?e.substring(0,e.length-1):e}function Ot(e={}){return j([{provide:Q,useValue:e},{provide:Y,useFactory:it,deps:[Q]},{provide:E,useClass:e.serializer?e.serializer:e.routerState===P.Full?m:R},D(()=>b(B)),B])}function st(){return V(X)}function yt(e=st()){let t=c(e,r=>r&&r.state),o=c(t,r=>r&&r.root),i=c(o,r=>{if(!r)return;let a=r;for(;a.firstChild;)a=a.firstChild;return a}),s=c(o,r=>r&&r.fragment),n=c(o,r=>r&&r.queryParams),u=r=>c(n,a=>a&&a[r]),g=c(i,r=>r&&r.params),p=r=>c(g,a=>a&&a[r]),I=c(i,r=>r&&r.data),Z=r=>c(I,a=>a&&a[r]),tt=c(t,r=>r&&r.url),et=c(i,r=>{if(r?.routeConfig)return typeof r.routeConfig.title=="string"?r.routeConfig.title:r.title});return{selectCurrentRoute:i,selectFragment:s,selectQueryParams:n,selectQueryParam:u,selectRouteParams:g,selectRouteParam:p,selectRouteData:I,selectRouteDataParam:Z,selectUrl:tt,selectTitle:et}}export{St as a,Ot as b,yt as c,nt as d};
