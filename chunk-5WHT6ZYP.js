import{a as gt,b as yt,c as It}from"./chunk-QAURH6TU.js";import{a as rt,b as lt,e as st,g as dt,h as P,j as pt,k as mt,o as ct,p as ut,q as ft,r as _t,t as xt,u as Ct,v as ht}from"./chunk-I4XIPXUR.js";import{a as D,c as Ft,d as jt}from"./chunk-2Q6MXQZT.js";import{b as Pt,c as Mt,e as Dt}from"./chunk-7VF5P2K4.js";import{d as St}from"./chunk-KFR4YWFV.js";import{b as Et,c as wt,d as Tt}from"./chunk-4CXL2XJP.js";import{A as ot,B as nt,Y as bt,c as E,e as G,f as Q,h as q,i as H,j as K,ja as vt,k as W,s as Y,t as Z,y as it,z as at}from"./chunk-XV2UP6CS.js";import{a as Bt,b as kt,c as Ot,d as Vt,e as Rt,f as Nt}from"./chunk-ZMC2R4JL.js";import{$a as N,Db as y,Fb as c,Fc as U,Jb as p,Kb as _,Lb as I,Qb as F,Qd as J,Rd as X,Sb as T,Tb as j,Td as $,U as k,Ub as n,Ud as tt,Vb as r,Vd as et,Xa as i,Ya as f,Zb as z,_b as L,a as B,ac as A,ea as O,hb as C,ib as m,kb as w,ob as S,pb as x,ra as V,sa as R,tb as l,ub as s,vb as h,xa as b,ya as v,zb as g}from"./chunk-RCQUF6CP.js";function qt(t,d){if(t&1){let e=g();l(0,"div",12)(1,"button",13),y("deleted",function(){b(e);let o=c(2);return v(o.onDeleted())}),p(2),n(3,"translate"),s()()}if(t&2){let e=c(2);i(1),m("appPostDelete",e.dataSource.data().id),i(1),I(" ",r(3,2,"uni.delete")," ")}}function Ht(t,d){if(t&1){let e=g();l(0,"button",14),y("click",function(){b(e);let o=c(2);return o.form.controls.title.setValue(""),v(o.form.controls.body.markAsDirty())}),n(1,"translate"),n(2,"translate"),l(3,"mat-icon"),p(4,"close"),s()()}t&2&&(m("matTooltip",r(2,4,"uni.clear")),C("aria-label",r(1,2,"uni.clear")))}function Kt(t,d){if(t&1){let e=g();l(0,"button",14),y("click",function(){b(e);let o=c(2);return o.form.controls.body.setValue(""),v(o.form.controls.body.markAsDirty())}),n(1,"translate"),n(2,"translate"),l(3,"mat-icon"),p(4,"close"),s()()}t&2&&(m("matTooltip",r(2,4,"uni.clear")),C("aria-label",r(1,2,"uni.clear")))}function Wt(t,d){if(t&1){let e=g();S(0,qt,4,4,"div",1),l(1,"mat-card")(2,"mat-card-header")(3,"mat-card-subtitle"),p(4),s(),l(5,"mat-card-title"),p(6),s()(),l(7,"mat-card-content",2)(8,"form",3),y("ngSubmit",function(){b(e);let o=c();return v(o.onSubmit())})("reset",function(o){b(e);let u=c();return v(u.onReset(o))}),l(9,"mat-form-field",4)(10,"mat-label"),p(11),n(12,"translate"),s(),h(13,"input",5),S(14,Ht,5,6,"button",6),s(),l(15,"mat-form-field",4)(16,"mat-label"),p(17),n(18,"translate"),s(),h(19,"textarea",7,8),n(21,"translate"),S(22,Kt,5,6,"button",6),s(),l(23,"div",9)(24,"button",10),p(25),n(26,"translate"),s(),l(27,"button",11),p(28),n(29,"translate"),s()()()()()}if(t&2){let e=c();x(0,e.dataSource.state()==="data"?0:-1),i(3),w("blur-sm",e.dataSource.state()!=="data"),i(1),_("#"+e.dataSource.data().id),i(1),w("blur-sm",e.dataSource.state()!=="data"),i(1),_(e.dataSource.data().title),i(2),m("formGroup",e.form),i(3),_(r(12,17,"form.post.title.label")),i(3),x(14,e.form.controls.title.value?14:-1),i(3),_(r(18,19,"form.post.body.label")),i(2),m("placeholder",r(21,21,"form.post.body.placeholder")),i(3),x(22,e.form.controls.body.value?22:-1),i(2),m("disabled",e.form.pristine),i(1),I(" ",r(26,23,"uni.reset")," "),i(2),m("disabled",e.form.pristine||e.form.invalid),i(1),I(" ",r(29,25,"uni.submit")," ")}}function Jt(t,d){if(t&1&&(l(0,"mat-card")(1,"mat-card-content",15),h(2,"mat-icon",16),n(3,"translate"),l(4,"div"),p(5),s()()()),t&2){let e=c();i(2),C("aria-label",r(3,2,"uni.aria-label.error-icon")),i(3),_(e.dataSource.error())}}function Xt(t,d){t&1&&(l(0,"mat-card")(1,"mat-card-content",15),h(2,"mat-icon",17),n(3,"translate"),l(4,"div"),p(5),n(6,"translate"),s()()()),t&2&&(i(2),C("aria-label",r(3,2,"uni.aria-label.warning-icon")),i(3),_(r(6,4,"error.post-was-not-found")))}var Yt=(t,d)=>[t,d],zt=t=>[t];function Zt(t,d){if(t&1&&(h(0,"mat-icon",20),n(1,"translate"),l(2,"a",19),n(3,"localize"),p(4),s(),h(5,"mat-icon",20),n(6,"translate"),l(7,"a",19),n(8,"localize"),p(9),n(10,"translate"),s()),t&2){let e=c(2);C("aria-label",r(1,6,"uni.aria-label.arrow-icon")),i(2),m("routerLink",j(16,Yt,r(3,8,"/"),e.dataSource.data().id)),i(2),_(e.dataSource.data().id),i(1),C("aria-label",r(6,10,"uni.aria-label.arrow-icon")),i(2),m("routerLink",T(19,zt,r(8,12,"/"+e.dataSource.data().id+"/"+e.ROUTE_DEFINITION.POSTS.EDIT))),i(2),I(" ",r(10,14,"breadcrumbs.posts.edit"),"")}}function $t(t,d){if(t&1&&(l(0,"div",18)(1,"a",19),n(2,"localize"),p(3),n(4,"translate"),s(),S(5,Zt,11,21),s()),t&2){let e=c();i(1),m("routerLink",T(7,zt,r(2,3,"/"))),i(2),_(r(4,5,"breadcrumbs.app.posts")),i(2),x(5,e.dataSource.state()==="data"?5:-1)}}var Ge=(()=>{let d=class d{constructor(a,o,u,M,Lt,At,Ut,Gt,Qt){this.postCollection=a,this.translate=o,this.breadcrumbsPortalService=u,this.fb=M,this.snackBar=Lt,this.lr=At,this.confirm=Ut,this.router=Gt,this.store=Qt,this.destroyRef=V(N),this.dataSource=new Mt(D),this.ROUTE_DEFINITION=St,this.form=this.fb.nonNullable.group({title:["",[P.required,P.min(3)]],body:["",[P.required,P.min(3)]]})}canDeactivate(){return this.form.pristine||this.confirm.openCustomConfirmDialog(Et.UnsavedWork)}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent),this.store.select(Pt).pipe(jt(this.dataSource),Ft(),O(a=>this.postCollection.getByKey(a)),Q(this.destroyRef)).subscribe({next:a=>{this.dataSource.setData(a),this.form.patchValue(a)},error:a=>{if(a instanceof U&&a.status>=400&&a.status<500)this.dataSource.setData(D);else{let o=this.translate.instant("error.unexpected-exception");this.dataSource.setError(o)}}})}ngOnDestroy(){this.portalContent?.detach()}onSubmit(){this.postCollection.update(B({id:this.dataSource.data().id},this.form.value)).pipe(k()).subscribe({next:a=>{this.dataSource.setData(a),this.form.reset(a),this.snackBar.open(this.translate.instant("response.update.success"),this.translate.instant("uni.close"))},error:()=>{this.snackBar.open(this.translate.instant("response.update.failed"),this.translate.instant("uni.close"))}})}onReset(a){a.preventDefault(),this.form.reset(this.dataSource.data())}onDeleted(){let a=this.lr.translateRoute("/");this.router.navigate([a])}};d.\u0275fac=function(o){return new(o||d)(f(Tt),f($),f(nt),f(_t),f(bt),f(it),f(wt),f(Y),f(vt))},d.\u0275cmp=R({type:d,selectors:[["app-post-edit"]],viewQuery:function(o,u){if(o&1&&L(E,7),o&2){let M;z(M=A())&&(u.portalContent=M.first)}},standalone:!0,features:[F],decls:4,vars:3,consts:[["class","container flex items-center gap-1 py-4",4,"cdkPortal"],["class","flex items-end justify-end gap-2"],[1,"flex","flex-col","gap-2","mt-2","text-center"],[3,"formGroup","ngSubmit","reset"],[1,"w-full"],["matInput","","type","text","formControlName","title"],["matSuffix","","mat-icon-button","",3,"matTooltip"],["matInput","","cdkTextareaAutosize","","formControlName","body",3,"placeholder"],["autosize","cdkTextareaAutosize"],[1,"flex","justify-center","gap-2"],["mat-button","","color","primary","type","reset",3,"disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"flex","items-end","justify-end","gap-2"],["mat-button","","color","accent",3,"appPostDelete","deleted"],["matSuffix","","mat-icon-button","",3,"matTooltip","click"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","fontIcon","error"],["aria-hidden","false","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["mat-button","","color","primary",3,"routerLink"],["aria-hidden","false","fontIcon","chevron_right"]],template:function(o,u){o&1&&S(0,Wt,30,27,"mat-card")(1,Jt,6,4,"mat-card")(2,Xt,7,6,"mat-card")(3,$t,6,9,"div",0),o&2&&(x(0,u.dataSource.state()==="loading"||u.dataSource.state()==="data"?0:-1),i(1),x(1,u.dataSource.state()==="error"?1:-1),i(1),x(2,u.dataSource.state()==="empty"?2:-1))},dependencies:[G,E,X,J,W,H,q,K,Nt,Bt,Ot,Rt,Vt,kt,It,yt,st,rt,lt,gt,ht,Ct,xt,ct,dt,pt,mt,ut,ft,et,tt,Z,ot,at,Dt],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0});let t=d;return t})();export{Ge as PostEditComponent};
